<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type='text/css' href="../CSS/text.css">
    <script type="text/javascript" src="../JS/text.js"></script>
    <script src="../JS/saveJSON.js"></script>
    <script src='../JS/disposeJSON.js'></script>
    <title>Base Communication</title>
</head>
<body>
    <h1>If you see this message, it means that your electron application is running successfully!</h1>
    <button id='startSocket'>Start socket</button><!--启动socket链接-->
    <script type="module">
        const ioi = require('socket.io-client');
        var socket;
        $("startSocket").onclick = function click() { //监听点击事件，然后运行socket，这里用“贴标签”的形式调用socket.js
            var inputIP = document.createElement('input');
            inputIP.type = 'text';
            inputIP.id = "InputIP";
            var submitIP = document.createElement('button');
            submitIP.type = 'submit';
            submitIP.innerText = "Submit";
            submitIP.id = "socketSubmitIP";
            var endSocketIP = document.createElement('button');
            endSocketIP.innerText = "Close socket";
            endSocketIP.id = "endSocket";
            endSocketIP.type = 'submit';
            document.body.appendChild(submitIP);
            document.body.appendChild(endSocketIP);
            document.body.appendChild(inputIP);
            console.log("函数被执行"); //For Developer
            $("socketSubmitIP").onclick = function submit() { 
                socket = ioi("http://"+inputIP.value+":3000");
                console.log(inputIP.value);
                readJSON();
            }
            $("endSocket").onclick = function endClick() {
                console.log("结束socket函数执行");
                if(socket.connected) socket.close();
                $("socketInputIP").remove();
                $("socketSubmitIP").remove();
                $("endSocket").remove();
            }
        }
    </script>
</body>
<!-- <script>
    
    // if(flag == 1) {
    //     delete click();
    // }
</script> -->
</html>